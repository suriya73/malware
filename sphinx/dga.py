# Sphinx Zeus DGA PoC
# Dennis Schwarz, Arbor Networks, ASERT, October 2016

import ctypes

def dga(year, month, day):
    ymd_str = "%d%d%d" % (year, month, day)
    seed = int(ymd_str)

    domains = []
    for idx in range(128):
        domain = []
        for i in range(16):
            seed = (idx + i + ((seed >> 0x18) & 0xff | (seed << 0x8)) + 0x2ab3fea3) & 0xffffffff
            s_seed = ctypes.c_int(seed).value
            domain.append(chr((abs(s_seed) % 0x19) + ord("a")))

        domain = "".join(domain) + ".com"
        domains.append(domain)

    return domains


if __name__ == "__main__":
    domains = dga(2016, 10, 13)
    for domain in domains:
        print domain
