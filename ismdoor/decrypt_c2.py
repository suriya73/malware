# decrypts ismdoor-dns' encrypted config
# https://www.virustotal.com/en/file/5bc0a1f33c982916c8085076e8898ddbe8726249867b47df02e58ac3bf466b27/analysis/

import struct

mapping = {
    167: "a",
    212: "b",
    208: "c",
    210: "d",
    216: "e",
    165: "f",
    182: "g",
    294: "h",
    404: "i",
    386: "j",
    400: "k",
    391: "l",
    590: "m",
    677: "n",
    687: "o",
    624: "p",
    679: "q",
    684: "r",
    622: "s",
    670: "t",
    685: "u",
    566: "v",
    580: "w",
    545: "x",
    680: "y",
    552: "z",
    486: "0",
    533: "1",
    496: "2",
    565: "3",
    576: "4",
    654: "5",
    446: "6",
    447: "7",
    445: "8",
    390: "9",
    223: "\n",
    287: "\r",
    295: ":",
    338: ".",
    422: "/",
    407: "\\",
    231: "-"
}

encbuf = 'R\x01\xd2\x00\xa5\x02n\x02\x87\x01\xaf\x02\xaf\x02\x90\x01\xad\x02p\x02\xd2\x00\xa7\x00\x9e\x02\xd8\x00\xac\x02R\x01\xd0\x00\xaf\x02N\x02\x1f\x01\xdf\x005\x02\xe6\x01\x1f\x01\xdf\x00\xe7\x00\x15\x02\x1f\x01\xdf\x00\xe6\x01\x1f\x01\xdf\x00\xe7\x00\x15\x02\x1f\x01\xdf\x00\xe6\x01\x1f\x01\xdf\x00\xe6\x01\x1f\x01\xdf\x00R\x01\xd2\x00\xa5\x02n\x02n\x02\xd8\x00\xd0\x00\xad\x02p\x02\xd2\x00\xa7\x00\x9e\x02\xd8\x00\xac\x02R\x01\xd0\x00\xaf\x02N\x02\x1f\x01\xdf\x00\xe6\x01\x1f\x01\xdf\x00\xe6\x01\x1f\x01\xdf\x00\xf0\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\x1f\x01\xdf\x00\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe7\x00\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe7\x00\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe7\x00\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe7\x00\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01\xe6\x01'

plainbuf = []
for i in range(0, len(encbuf), 2):
    word = struct.unpack("H", encbuf[i:i+2])[0]
    plainbuf.append(mapping[word])

plainbuf = "".join(plainbuf)
print plainbuf
